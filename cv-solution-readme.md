# CV часть решение для позиционирования объекта

Этот проект реализует систему позиционирования в помещении на основе компьютерного зрения для дронов (в качестве прокси используется мобильный телефон) в условиях отсутствия GPS, разработанную для хакатона. Система поддерживает два режима работы:

- **Без маркеров**: Используется только компьютерное зрение (Faster R-CNN для детекции телефона и MiDaS для оценки расстояния до него).
- **С маркерами**: Дополнительно детектируются физические ArUco-маркеры (маяки) для расчёта 3D-расстояний, комбинируя данные от Faster R-CNN и MiDaS.

Решение использует экспоненциальное скользящее среднее (EMA) для сглаживания позиций и расстояний, обеспечивая точность, стабильность и масштабируемость.

## Возможности

- **Детекция объекта**: Модель Faster R-CNN (ResNet50-FPN) обнаруживает мобильный телефон (класс COCO 'cell phone', индекс 77) как дрон.
- **Детекция маяков**: Поддерживает физические ArUco-маркеры (DICT_6X6_250, размер \~10 см) как маяки для оценки 3D-расстояний (опционально). Без маркеров выводится "No beacons detected".
- **Сглаживание**: EMA (alpha=0.3) стабилизирует bounding box телефона, его центр и расстояния, минимизируя дерганье.
- **Оценка глубины**: Модель MiDaS (small) оценивает глубину (вызывается раз в 5 кадров) для расчёта расстояний до телефона и маркеров (если они есть).
- **Вывод**: Отображаются:
  - Зелёный bounding box вокруг телефона с расстоянием (в см).
  - Красные bounding box'ы вокруг маркеров с 3D-расстояниями (если маркеры есть).
  - Сообщение "No beacons detected" при отсутствии маркеров.
- **Гибкость**: Работает с веб-камерой, маркеры опциональны, разрешение кадра (640x480) можно уменьшить для повышения FPS.

## Требования

- **Оборудование**:
  - Веб-камера (рекомендуется 30 FPS)
  - Опционально: физические ArUco-маркеры (DICT_6X6_250, размер \~10 см, распечатанные или на экране)
  - Опционально: GPU (NVIDIA с CUDA) для повышения производительности
- **Программное обеспечение**:
  - Python 3.8+
  - Зависимости:
    - torch==2.0.1
    - torchvision==0.15.2
    - opencv-contrib-python==4.10.0.84
    - numpy==1.24.3
    - pillow==9.5.0